# ğŸš— Car Rental DApp â€“ Frontend Functional Specification

This document provides **detailed functional requirements** for the frontend integration with the `FixedRentalContract` smart contract.  

âœ… **Theme and styling descriptions are omitted**.  
âœ… **Navigation bar will NOT include links to Admin or Inspector** (they will be accessed via role detection).  
âœ… **Every page includes a MetaMask Connect button + Preview Mode toggle**.  
âœ… **When MetaMask is connected or Preview Mode is ON**, the page expands to show its detailed contents.

---

## ğŸŒ Global Behavior

- **Wallet Connection**
  - A `Connect Wallet` button is present on every page.
  - When clicked, MetaMask prompts the user to connect.
  - Once connected, the frontend detects role based on wallet address:
    - `Admin/Lessor` â†’ the wallet that deployed the contract.
    - `Inspector` â†’ a predefined wallet address assigned at deployment.
    - `User` â†’ any other wallet.
- **Preview Mode**
  - A toggle switch next to the Connect Wallet button.
  - When activated, the UI displays all page sections **without MetaMask**.
  - Preview Mode **disables transaction calls** and **shows demo state only** (read-only simulation).

---

## ğŸ  1. Homepage

**Purpose:** Overview of the platform and quick access to actions.

### ğŸ”‘ Functional Flow
- Show `Connect Wallet` button and `Preview Mode` toggle side by side.
- After wallet connection or Preview Mode:
  - **Car List Section**
    - Displays all cars from the contract with:
      - `assetName`
      - `rentalFeePerDay`
      - `insuranceFee`
      - Current state: `Available`, `Rented`, `Awaiting Return Confirmation`
    - Each car card shows:
      - Owner wallet
      - If currently rented: show renter wallet
      - Status tags (colored label)
    - **Action buttons on each car card**:
      - If role = User â†’ â€œRent Carâ€
      - If role = Admin â†’ â€œManage Carâ€
      - If role = Inspector â†’ â€œInspect Carâ€ (only cars in return state)

---

## ğŸš™ 2. Lend Car Page (Admin)

**Purpose:** For the Lessor/Admin to add and manage cars.

### ğŸ”‘ Functional Flow
- Visible only if connected wallet = Admin OR Preview Mode with Admin role selected.
- **Car Registration Form**
  - Inputs: `Car Name`, `Rental Fee Per Day`, `Duration (days)`, `Insurance Fee`.
  - Button **â€œDeploy Car Contractâ€**: Deploys a new contract instance (calls constructor).
- **Owned Cars List**
  - Shows all cars owned by the Admin.
  - Each card displays:
    - Car status
    - Current renter (if any)
    - Deposit amount collected
  - **Action Buttons:**
    - `Set Actual Usage` â†’ Opens modal to input days used â†’ calls `setActualUsage()`.
    - `Confirm Return` â†’ Calls `confirmReturn()`.
    - `Report Damage` â†’ Calls `reportDamage()`.

---

## ğŸš— 3. Rent Car Page (Users)

**Purpose:** For general users to rent available cars.

### ğŸ”‘ Functional Flow
- All available cars (status = Available) shown.
- **Car Detail Popup** when a car is clicked:
  - Displays:
    - Deposit required (`getDeposit()`)
    - Total rental fee (`getTotalRentalFee()`)
    - Rental duration
  - Buttons:
    - **Rent** â†’ triggers `rent()` with ETH deposit.
    - **Cancel Rental** â†’ triggers `cancelRental()` if they already rented this car.
    - **Request Return** â†’ triggers `requestReturn()` (lessee only).
    - **Complete Rental** â†’ triggers `completeRental()` with ETH payment of `getRemainingPayment()`.

---

## ğŸ“œ 4. Transaction Page

**Purpose:** A transparent feed of all contract activity.

### ğŸ”‘ Functional Flow
- Uses Ethers.js to listen for events:
  - `RentalStarted`
  - `RenterRequestedReturn`
  - `OwnerConfirmedReturn`
  - `DamageReported`
  - `DamageAssessed`
  - `FundsTransferred`
- **Filter/Sort options:**
  - Filter by `Car`, `Date`, or `Wallet Address`.
- **Export**: Button to download transaction log as CSV.

---

## ğŸ›  5. Admin Panel (Auto-shown when Admin Wallet is connected)

**Purpose:** Central management for the Lessor.

### ğŸ”‘ Functional Flow
- Summary of all cars:
  - Number of active rentals
  - Total revenue from `FundsTransferred`
- Actions per car:
  - Same as Lend Car page (set usage, confirm return, report damage).

---

## ğŸ•µï¸ 6. Inspector Panel (Auto-shown when Inspector Wallet is connected)

**Purpose:** Dedicated view for the damage assessor.

### ğŸ”‘ Functional Flow
- List of cars **awaiting inspection** (returned but not finalized).
- **Damage Assessment Form**
  - Input: Damage fee (ETH).
  - Button: **Submit Assessment** â†’ calls `assessDamage()`.
- **History Section**
  - Displays all past `DamageAssessed` events.

---

## ğŸ“¦ UI Component Behavior

- **MetaMask/Preview Header Section**
  - Always visible at top of each page.
  - Includes:
    - â€œConnect Walletâ€ button.
    - â€œPreview Modeâ€ toggle.
    - When connected:
      - Shows connected wallet address.
      - Shows detected role (Admin, User, Inspector).
    - When Preview Mode is active:
      - Dropdown to simulate roles.

- **Conditional Page Content**
  - Content only expands **after wallet connection OR Preview Mode**.

---

## âœ… Notes for Frontend Dev

- **No mock data when connected to wallet**: Must pull real contract state from chain.
- **Preview Mode** can use **temporary local state** just for layout purposes.
- **Role detection** must occur on wallet connect:
  - `lessor` â†’ Admin Panel + Lend Car features.
  - `damageAssessor` â†’ Inspector Panel features.
  - Others â†’ Rent Car features.
